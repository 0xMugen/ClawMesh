mode = "merge"
# merge-as-you-go for fast iteration
